.\" Automatically generated by Pod::Man 2.23 (Pod::Simple 3.14)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "AFSMONITOR 1"
.TH AFSMONITOR 1 "2011-09-06" "OpenAFS" "AFS Command Reference"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
afsmonitor \- Monitors File Servers and Cache Managers
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fBafsmonitor\fR [\fBinitcmd\fR] [\-config <\fIconfiguration file\fR>]
    [\fB\-frequency\fR\ <\fIpoll\ frequency,\ in\ seconds\fR>]
    [\fB\-output\fR\ <\fIstorage\ file\ name\fR>] [\fB\-detailed\fR]
    [\fB\-debug\fR\ <\fIdebug\ output\ file\fR>]
    [\fB\-fshosts\fR\ <\fIlist\ of\ file\ servers\ to\ monitor\fR>+]
    [\fB\-cmhosts\fR\ <\fIlist\ of\ cache\ managers\ to\ monitor\fR>+]
    [\fB\-buffers\fR\ <\fInumber\ of\ buffer\ slots\fR>] [\fB\-help\fR]
.PP
\&\fBafsmonitor\fR [\fBi\fR]  [\-co <\fIconfiguration file\fR>]
    [\fB\-fr\fR\ <\fIpoll\ frequency,\ in\ seconds\fR>]
    [\fB\-o\fR\ <\fIstorage\ file\ name\fR>] [\fB\-det\fR]
    [\fB\-deb\fR\ <\fIdebug\ output\ file\fR>]
    [\fB\-fs\fR\ <\fIlist\ of\ file\ servers\ to\ monitor\fR>+]
    [\fB\-cm\fR\ <\fIlist\ of\ cache\ managers\ to\ monitor\fR>+]
    [\fB\-b\fR\ <\fInumber\ of\ buffer\ slots\fR>] [\fB\-h\fR]
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
The afsmonitor command initializes a program that gathers and displays
statistics about specified File Server and Cache Manager operations. It
allows the issuer to monitor, from a single location, a wide range of File
Server and Cache Manager operations on any number of machines in both
local and foreign cells.
.PP
There are 271 available File Server statistics and 571 available Cache
Manager statistics, listed in the appendix about \fBafsmonitor\fR statistics
in the \fIOpenAFS Administration Guide\fR. By default, the command displays
all of the relevant statistics for the file server machines named by the
\&\fB\-fshosts\fR argument and the client machines named by the \fB\-cmhosts\fR
argument. To limit the display to only the statistics of interest, list
them in the configuration file specified by the \fB\-config\fR argument. In
addition, use the configuration file for the following purposes:
.IP "\(bu" 4
To set threshold values for any monitored statistic. When the value of a
statistic exceeds the threshold, the \fBafsmonitor\fR command displays it in
reverse video. There are no default threshold values.
.IP "\(bu" 4
To invoke a program or script automatically when a statistic exceeds its
threshold. The \s-1AFS\s0 distribution does not include any such scripts.
.IP "\(bu" 4
To list the file server and client machines to monitor, instead of using
the \fB\-fshosts\fR and \fB\-cmhosts\fR arguments.
.PP
For a description of the configuration file, see \fIafsmonitor\fR\|(5).
.SH "CAUTIONS"
.IX Header "CAUTIONS"
The following software must be accessible to a machine where the
\&\fBafsmonitor\fR program is running:
.IP "\(bu" 4
The \s-1AFS\s0 xstat libraries, which the afsmonitor program uses to gather data.
.IP "\(bu" 4
The curses graphics package, which most \s-1UNIX\s0 distributions provide as a
standard utility.
.PP
The \fBafsmonitor\fR screens format successfully both on so-called dumb
terminals and in windowing systems that emulate terminals. For the output
to looks its best, the display environment needs to support reverse video
and cursor addressing. Set the \s-1TERM\s0 environment variable to the correct
terminal type, or to a value that has characteristics similar to the
actual terminal type. The display window or terminal must be at least 80
columns wide and 12 lines long.
.PP
The \fBafsmonitor\fR program must run in the foreground, and in its own
separate, dedicated window or terminal. The window or terminal is
unavailable for any other activity as long as the \fBafsmonitor\fR program is
running. Any number of instances of the \fBafsmonitor\fR program can run on a
single machine, as long as each instance runs in its own dedicated window
or terminal. Note that it can take up to three minutes to start an
additional instance.
.SH "OPTIONS"
.IX Header "OPTIONS"
.IP "\fBinitcmd\fR" 4
.IX Item "initcmd"
Accommodates the command's use of the \s-1AFS\s0 command parser, and is optional.
.IP "\fB\-config\fR <\fIfile\fR>" 4
.IX Item "-config <file>"
Names the configuration file which lists the machines to monitor,
statistics to display, and threshold values, if any. A partial pathname is
interpreted relative to the current working directory. Provide this
argument if not providing the \fB\-fshosts\fR argument, \fB\-cmhosts\fR argument,
or neither. For instructions on creating this file, see the preceding
\&\fB\s-1DESCRIPTION\s0\fR section, and the section on the \fBafsmonitor\fR program in
the \fIOpenAFS Administration Guide\fR.
.IP "\fB\-frequency\fR <\fIpoll frequency\fR>" 4
.IX Item "-frequency <poll frequency>"
Specifies in seconds how often the afsmonitor program probes the File
Servers and Cache Managers. Valid values range from \f(CW1\fR to \f(CW86400\fR
(which is 24 hours); the default value is \f(CW60\fR. This frequency applies to
both File Servers and Cache Managers, but the \fBafsmonitor\fR program
initiates the two types of probes, and processes their results,
separately. The actual interval between probes to a host is the probe
frequency plus the time required for all hosts to respond.
.IP "\fB\-output\fR <\fIfile\fR>" 4
.IX Item "-output <file>"
Names the file to which the afsmonitor program writes all of the
statistics that it collects. By default, no output file is created. See
the section on the \fBafsmonitor\fR command in the \fIOpenAFS Administration
Guide\fR for information on this file.
.IP "\fB\-detailed\fR" 4
.IX Item "-detailed"
Formats the information in the output file named by \fB\-output\fR argument in
a maximally readable format. Provide the \fB\-output\fR argument along with
this one.
.IP "\fB\-fshosts\fR <\fIhost\fR>+" 4
.IX Item "-fshosts <host>+"
Names one or more machines from which to gather File Server
statistics. For each machine, provide either a fully qualified host name,
or an unambiguous abbreviation (the ability to resolve an abbreviation
depends on the state of the cell's name service at the time the command is
issued). This argument can be combined with the \fB\-cmhosts\fR argument, but
not with the \fB\-config\fR argument.
.IP "\fB\-cmhosts\fR <\fIhost\fR>+" 4
.IX Item "-cmhosts <host>+"
Names one or more machines from which to gather Cache Manager
statistics. For each machine, provide either a fully qualified host name,
or an unambiguous abbreviation (the ability to resolve an abbreviation
depends on the state of the cell's name service at the time the command is
issued). This argument can be combined with the \fB\-fshosts\fR argument, but
not with the \fB\-config\fR argument.
.IP "\fB\-buffers\fR <\fIslots\fR>" 4
.IX Item "-buffers <slots>"
Is nonoperational and provided to accommodate potential future
enhancements to the program.
.IP "\fB\-help\fR" 4
.IX Item "-help"
Prints the online help for this command. All other valid options are
ignored.
.SH "OUTPUT"
.IX Header "OUTPUT"
The afsmonitor program displays its data on three screens:
.IP "System Overview" 4
.IX Item "System Overview"
This screen appears automatically when the \fBafsmonitor\fR program
initializes. It summarizes separately for File Servers and Cache Managers
the number of machines being monitored and how many of them have \fIalerts\fR
(statistics that have exceeded their thresholds). It then lists the
hostname and number of alerts for each machine being monitored, indicating
if appropriate that a process failed to respond to the last probe.
.IP "File Server" 4
.IX Item "File Server"
This screen displays File Server statistics for each file server machine
being monitored. It highlights statistics that have exceeded their
thresholds, and identifies machines that failed to respond to the last
probe.
.IP "Cache Managers" 4
.IX Item "Cache Managers"
This screen displays Cache Manager statistics for each client machine
being monitored. It highlights statistics that have exceeded their
thresholds, and identifies machines that failed to respond to the last
probe.
.PP
Fields at the corners of every screen display the following information:
.IP "\(bu" 4
In the top left corner, the program name and version number.
.IP "\(bu" 4
In the top right corner, the screen name, current and total page numbers,
and current and total column numbers. The page number (for example, \f(CW\*(C`p. 1
of 3\*(C'\fR) indicates the index of the current page and the total number of
(vertical) pages over which data is displayed. The column number (for
example, \f(CW\*(C`c. 1 of 235\*(C'\fR) indicates the index of the current leftmost
column and the total number of columns in which data appears. (The symbol
\&\f(CW\*(C`>>>\*(C'\fR indicates that there is additional data to the right; the
symbol \f(CW\*(C`<<<\*(C'\fR indicates that there is additional data to the
left.)
.IP "\(bu" 4
In the bottom left corner, a list of the available commands. Enter the
first letter in the command name to run that command. Only the currently
possible options appear; for example, if there is only one page of data,
the \f(CW\*(C`next\*(C'\fR and \f(CW\*(C`prev\*(C'\fR commands, which scroll the screen up and down
respectively, do not appear. For descriptions of the commands, see the
following section about navigating the display screens.
.IP "\(bu" 4
In the bottom right corner, the \f(CW\*(C`probes\*(C'\fR field reports how many times the
program has probed File Servers (\f(CW\*(C`fs\*(C'\fR), Cache Managers (\f(CW\*(C`cm\*(C'\fR), or
both. The counts for File Servers and Cache Managers can differ. The
\&\f(CW\*(C`freq\*(C'\fR field reports how often the program sends probes.
.SS "Navigating the afsmonitor Display Screens"
.IX Subsection "Navigating the afsmonitor Display Screens"
As noted, the lower left hand corner of every display screen displays the
names of the commands currently available for moving to alternate screens,
which can either be a different type or display more statistics or
machines of the current type. To execute a command, press the lowercase
version of the first letter in its name. Some commands also have an
uppercase version that has a somewhat different effect, as indicated in
the following list.
.ie n .IP """cm""" 4
.el .IP "\f(CWcm\fR" 4
.IX Item "cm"
Switches to the \f(CW\*(C`Cache Managers\*(C'\fR screen. Available only on the \f(CW\*(C`System
Overview\*(C'\fR and \f(CW\*(C`File Servers\*(C'\fR screens.
.ie n .IP """fs""" 4
.el .IP "\f(CWfs\fR" 4
.IX Item "fs"
Switches to the \f(CW\*(C`File Servers\*(C'\fR screen. Available only on the \f(CW\*(C`System
Overview\*(C'\fR and the \f(CW\*(C`Cache Managers\*(C'\fR screens.
.ie n .IP """left""" 4
.el .IP "\f(CWleft\fR" 4
.IX Item "left"
Scrolls horizontally to the left, to access the data columns situated to
the left of the current set. Available when the \f(CW\*(C`<<<\*(C'\fR symbol
appears at the top left of the screen. Press uppercase \f(CW\*(C`L\*(C'\fR to scroll
horizontally all the way to the left (to display the first set of data
columns).
.ie n .IP """next""" 4
.el .IP "\f(CWnext\fR" 4
.IX Item "next"
Scrolls down vertically to the next page of machine names.  Available when
there are two or more pages of machines and the final page is not
currently displayed. Press uppercase \f(CW\*(C`N\*(C'\fR to scroll to the final page.
.ie n .IP """oview""" 4
.el .IP "\f(CWoview\fR" 4
.IX Item "oview"
Switches to the \f(CW\*(C`System Overview\*(C'\fR screen. Available only on the \f(CW\*(C`Cache
Managers\*(C'\fR and \f(CW\*(C`File Servers\*(C'\fR screens.
.ie n .IP """prev""" 4
.el .IP "\f(CWprev\fR" 4
.IX Item "prev"
Scrolls up vertically to the previous page of machine names.  Available
when there are two or more pages of machines and the first page is not
currently displayed. Press uppercase \f(CW\*(C`N\*(C'\fR to scroll to the first page.
.ie n .IP """right""" 4
.el .IP "\f(CWright\fR" 4
.IX Item "right"
Scrolls horizontally to the right, to access the data columns situated to
the right of the current set. This command is available when the \f(CW\*(C`>>>\*(C'\fR symbol appears at the upper right of the screen. Press uppercase \f(CW\*(C`R\*(C'\fR
to scroll horizontally all the way to the right (to display the final set
of data columns).
.SS "The System Overview Screen"
.IX Subsection "The System Overview Screen"
The \f(CW\*(C`System Overview\*(C'\fR screen appears automatically as the \fBafsmonitor\fR
program initializes. This screen displays the status of as many File
Server and Cache Manager processes as can fit in the current window;
scroll down to access additional information.
.PP
The information on this screen is split into File Server information on
the left and Cache Manager information on the right. The header for each
grouping reports two pieces of information:
.IP "\(bu" 4
The number of machines on which the program is monitoring the indicated
process.
.IP "\(bu" 4
The number of alerts and the number of machines affected by them (an
\&\fIalert\fR means that a statistic has exceeded its threshold or a process
failed to respond to the last probe).
.PP
A list of the machines being monitored follows. If there are any alerts on
a machine, the number of them appears in square brackets to the left of
the hostname. If a process failed to respond to the last probe, the
letters \f(CW\*(C`PF\*(C'\fR (probe failure) appear in square brackets to the left of the
hostname.
.SS "The File Servers Screen"
.IX Subsection "The File Servers Screen"
The \f(CW\*(C`File Servers\*(C'\fR screen displays the values collected at the most
recent probe for File Server statistics.
.PP
A summary line at the top of the screen (just below the standard program
version and screen title blocks) specifies the number of monitored File
Servers, the number of alerts, and the number of machines affected by the
alerts.
.PP
The first column always displays the hostnames of the machines running the
monitored File Servers.
.PP
To the right of the hostname column appear as many columns of statistics
as can fit within the current width of the display screen or window; each
column requires space for 10 characters. The name of the statistic appears
at the top of each column. If the File Server on a machine did not respond
to the most recent probe, a pair of dashes (\f(CW\*(C`\-\-\*(C'\fR) appears in each
column. If a value exceeds its configured threshold, it is highlighted in
reverse video. If a value is too large to fit into the allotted column
width, it overflows into the next row in the same column.
.SS "The Cache Managers Screen"
.IX Subsection "The Cache Managers Screen"
The \f(CW\*(C`Cache Managers\*(C'\fR screen displays the values collected at the most
recent probe for Cache Manager statistics.
.PP
A summary line at the top of the screen (just below the standard program
version and screen title blocks) specifies the number of monitored Cache
Managers, the number of alerts, and the number of machines affected by the
alerts.
.PP
The first column always displays the hostnames of the machines running the
monitored Cache Managers.
.PP
To the right of the hostname column appear as many columns of statistics
as can fit within the current width of the display screen or window; each
column requires space for 10 characters. The name of the statistic appears
at the top of each column. If the Cache Manager on a machine did not
respond to the most recent probe, a pair of dashes (\f(CW\*(C`\-\-\*(C'\fR) appears in each
column. If a value exceeds its configured threshold, it is highlighted in
reverse video. If a value is too large to fit into the allotted column
width, it overflows into the next row in the same column.
.SS "Writing to an Output File"
.IX Subsection "Writing to an Output File"
Include the \fB\-output\fR argument to name the file into which the
\&\fBafsmonitor\fR program writes all of the statistics it collects.  The
output file can be useful for tracking performance over long periods of
time, and enables the administrator to apply post-processing techniques
that reveal system trends. The \s-1AFS\s0 distribution does not include any
post-processing programs.
.PP
The output file is in \s-1ASCII\s0 format and records the same information as the
\&\f(CW\*(C`File Server\*(C'\fR and \f(CW\*(C`Cache Manager\*(C'\fR display screens.  Each line in the
file uses the following format to record the time at which the
\&\fBafsmonitor\fR program gathered the indicated statistic from the Cache
Manager (\f(CW\*(C`CM\*(C'\fR) or File Server (\f(CW\*(C`FS\*(C'\fR) running on the machine called
\&\fIhost_name\fR. If a probe failed, the error code \f(CW\*(C`\-1\*(C'\fR appears in the
\&\fIstatistic\fR field.
.PP
.Vb 1
\&   <time>  <host_name>  CM|FS   <statistic>
.Ve
.PP
If the administrator usually reviews the output file manually, rather than
using it as input to an automated analysis program or script, including
the \fB\-detail\fR flag formats the data in a more easily readable form.
.SH "EXAMPLES"
.IX Header "EXAMPLES"
For examples of commands, display screens, and configuration files, see
the section about the \fBafsmonitor\fR program in the \fIOpenAFS
Administration Guide\fR.
.SH "PRIVILEGE REQUIRED"
.IX Header "PRIVILEGE REQUIRED"
None
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIafsmonitor\fR\|(5)
\&\fIfstrace\fR\|(8),
\&\fIscout\fR\|(1)
.PP
The \fIOpenAFS Administration Guide\fR at
<http://docs.openafs.org/AdminGuide/>.
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
\&\s-1IBM\s0 Corporation 2000. <http://www.ibm.com/> All Rights Reserved.
.PP
This documentation is covered by the \s-1IBM\s0 Public License Version 1.0.  It was
converted from \s-1HTML\s0 to \s-1POD\s0 by software written by Chas Williams and Russ
Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.
