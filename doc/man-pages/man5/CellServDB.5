.\" Automatically generated by Pod::Man 2.23 (Pod::Simple 3.14)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "CELLSERVDB 5"
.TH CELLSERVDB 5 "2011-09-06" "OpenAFS" "AFS File Reference"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
CellServDB \- Lists the database server machines in AFS cells
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
There are two versions of the \fICellServDB\fR file, both of which have the
same format.  One version is used by an \s-1AFS\s0 client and lists all of the
database server machines in the local cell and any foreign cell that is to
be accessible from the local client machine.  The other version is used on
servers and need list only the database servers in the local cell; in some
configurations it can be a link to the same file the client uses.
.SS "Client CellServDB"
.IX Subsection "Client CellServDB"
Along with \s-1AFSDB\s0 entries in \s-1DNS\s0, the client version of the CellServDB file
lists the database server machines in the local cell and any foreign cell
that is to be accessible from the local client machine. Database server
machines run the Authentication Server (optional), Backup Server
(optional), Protection Server, and Volume Location (\s-1VL\s0) Server (the
\&\fBkaserver\fR, \fBbuserver\fR, \fBptserver\fR, and \fBvlserver\fR) processes, which
maintain the cell's administrative \s-1AFS\s0 databases.
.PP
The Cache Manager and other processes running on a client machine use the
list of a cell's database server machines when performing several common
functions, including:
.IP "\(bu" 4
Fetching files. The Cache Manager contacts the \s-1VL\s0 Server to learn
the location of the volume containing a requested file or directory.
.IP "\(bu" 4
Creating, viewing, and manipulating protection groups. The \fBpts\fR command
interpreter contacts the Protection Server when users create protection
groups or request information from the Protection Database.
.IP "\(bu" 4
Populating the contents of the fake \fIroot.afs\fR volume mounted at \fI/afs\fR
(or the alternative mount point specified in \fIcacheinfo\fR) when \fBafsd\fR is
run in \f(CW\*(C`\-dynroot\*(C'\fR mode.  The default contents of this directory will
match the cells listed in the client \fICellServDB\fR file.
.IP "\(bu" 4
Authenticating users. Client-side authentication programs (such as an
AFS-modified login utility or the \fBklog\fR command interpreter) contact the
Authentication Server to obtain a server ticket, which the \s-1AFS\s0 server
processes accept as proof that the user is authenticated. This only
applies to \s-1AFS\s0 cells using the deprecated Authentication Server instead of
Kerberos v5 and \fBaklog\fR.
.PP
The Cache Manager reads the CellServDB file into kernel memory as it
initializes, and not again until the machine next reboots or the client
service restarts. To enable users on the local machine to continue
accessing the cell correctly, update the file whenever a database server
machine is added to or removed from a cell. To update the kernel-resident
list of database server machines without rebooting, use the \fBfs newcell\fR
command.
.PP
If the client attempts to access an \s-1AFS\s0 cell not listed in \fICellServDB\fR
and \fBafsd\fR was started with the \fB\-afsdb\fR option, the Cache Manager will
attempt an \s-1AFSDB\s0 \s-1DNS\s0 record lookup and dynamically add the database server
locations for that cell based on the result of the \s-1DNS\s0 query.  If the
\&\fB\-afsdb\fR option was not used, all \s-1AFS\s0 cells that will be accessed by a
client machine must either be listed in \fICellServDB\fR or added with the
\&\fBfs newcell\fR command.
.PP
The \fICellServDB\fR file is in \s-1ASCII\s0 format and must reside in the
\&\fI/usr/vice/etc\fR directory on each \s-1AFS\s0 client machine. Use a text editor
to create and maintain it.
.PP
The client version of the \fICellServDB\fR file is distinct from the server
version, which resides in the \fI/usr/afs/etc\fR directory on each \s-1AFS\s0 server
machine. The client version lists the database server machines in every
\&\s-1AFS\s0 cell that the cell administrator wants the machine's users to be able
to access, whereas the server version lists only the local cell's database
server machines.
.SS "Server CellServDB"
.IX Subsection "Server CellServDB"
The server version of the \fICellServDB\fR file lists the local cell's
database server machines. These machines run the Authentication Server
(optional), Backup Server (optional), Protection Server, and Volume
Location (\s-1VL\s0) Server (the \fBkaserver\fR, \fBbuserver\fR, \fBptserver\fR, and
\&\fBvlserver\fR) processes, which maintain the cell's administrative \s-1AFS\s0
databases. The initial version of the file is created with the \fBbos
setcellname\fR command during the installation of the cell's server machine,
which is automatically recorded as the cell's first database server
machine. When adding or removing database server machines, be sure to
update this file appropriately. It must reside in the \fI/usr/afs/etc\fR
directory on each \s-1AFS\s0 server machine. The database server processes,
in addition to the usual configuration allowing each to be elected
synchronization site and coordinate updates, can be set up as readonly
database clone servers. Such servers can never be elected as the
synchronization site.
.PP
The database server processes consult the \fICellServDB\fR file to learn
about their peers, with which they must maintain constant connections in
order to coordinate replication of changes across the multiple copies of
each database. The other \s-1AFS\s0 server processes consult the file to learn
which machines to contact for information from the databases when they
need it.
.PP
Although the server \fICellServDB\fR file is in \s-1ASCII\s0 format, do not use a
text editor to alter it. Instead always use the appropriate commands from
the \fBbos\fR command suite:
.IP "\(bu" 4
The \fBbos addhost\fR command to add a machine to the file.
.IP "\(bu" 4
The \fBbos listhosts\fR command to display the list of machines from the
file.
.IP "\(bu" 4
The \fBbos removehost\fR command to remove a machine from the file.
.PP
In cells that use the Update Server to distribute the contents of the
\&\fI/usr/afs/etc\fR directory, it is customary to edit only the copy of the
file stored on the system control machine. Otherwise, edit the file on
each server machine individually. For instructions on adding and removing
database server machine, see the \fIOpenAFS Quick Start\fR chapter on
installing additional server machines. Updates to the server \fICellServDB\fR
will trigger reloading the cell server configurations automatically in the
\&\s-1AFS\s0 server processes.
.SS "CellServDB Format"
.IX Subsection "CellServDB Format"
Both \fICellServDB\fR files have the same format:
.IP "\(bu" 4
The first line begins at the left margin with the greater-than character
(\f(CW\*(C`>\*(C'\fR), followed immediately by the cell's name without an intervening
space. Optionally, a comment can follow any number of spaces and a octothorpe
(\f(CW\*(C`#\*(C'\fR), perhaps to identify the organization associated with the
cell. A variant of this allows the defintion of a linked cell: after the 
leading (\f(CW\*(C`>\*(C'\fR) and cell name, a space and a second cell name may be
listed before the optional spaces, octothorpe and comment.
.IP "\(bu" 4
Each subsequent line in the entry identifies one of the cell's database
server machines, with the indicated information in order:
.RS 4
.IP "\(bu" 4
The database server machine's \s-1IP\s0 address in dotted-decimal format, optionally
enclosed in square braces (\f(CW\*(C`[\*(C'\fR)(\f(CW\*(C`]\*(C'\fR) to define a non-voting clone.
.IP "\(bu" 4
One or more spaces.
.IP "\(bu" 4
An octothorpe (#), followed by the machine's fully qualified hostname
without an intervening space. This number sign does not indicate that the
hostname is a comment. It is a required field.
.RE
.RS 4
.RE
.PP
No extra blank lines or newline characters are allowed in the file, even
after the last entry. Their presence can prevent the Cache Manager from
reading the file into kernel memory, resulting in an error message.
.PP
For the client \fICellServDB\fR, it may be desirable to make the client aware
of a cell (so that it's listed by default in \fI/afs\fR when the \fB\-dynroot\fR
flag to \fBafsd\fR is in use, for instance) without specifying the database
server machines for that cell.  This can be done by including only the
cell line (starting with \f(CW\*(C`>\*(C'\fR) and omitting any following database
server machine lines.  This only works if \fBafsd\fR is configured, with the
\&\fB\-afsdb\fR option, to use \s-1AFSDB\s0 record lookups to locate database server
machines.  If the cell has such records and the client is configured to
use them, this configuration won't require updates to the client
\&\fICellServDB\fR file when the \s-1IP\s0 addresses of the database server machines
change.
.PP
grand.central.org maintains a list of the database server machines in all
cells that have registered themselves as receptive to access from foreign
cells. When a cell's administrators change its database server machines,
it is customary to register the change with grand.central.org for
inclusion in this file. The file conforms to the required \fICellServDB\fR
format, and so is a suitable basis for the \fICellServDB\fR file on a client
machine.  You can download this file from <http://grand.central.org/>.
.SH "EXAMPLES"
.IX Header "EXAMPLES"
The following example shows entries for two cells in a client
\&\fICellServDB\fR file and illustrates the required format.
.PP
.Vb 7
\&   >abc.com        # ABC Corporation
\&   192.12.105.2         #db1.abc.com
\&   192.12.105.3         #db2.abc.com
\&   [192.12.107.3]       #db3.abc.com
\&   >test.abc.com abc.com   # ABC Corporation Test Cell
\&   192.12.108.57        #testdb1.abc.com
\&   192.12.108.55        #testdb2.abc.com
.Ve
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIafsd\fR\|(8),
\&\fIbos_addhost\fR\|(8),
\&\fIbos_listhosts\fR\|(8),
\&\fIbos_removehost\fR\|(8),
\&\fIbos_setcellname\fR\|(8),
\&\fIbuserver\fR\|(8),
\&\fIfs_newcell\fR\|(1),
\&\fIkaserver\fR\|(8),
\&\fIklog\fR\|(1),
\&\fIptserver\fR\|(8),
\&\fIvlserver\fR\|(8),
\&\fIupclient\fR\|(8),
\&\fIupserver\fR\|(8)
.PP
\&\fIOpenAFS Quick Start\fR
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
\&\s-1IBM\s0 Corporation 2000. <http://www.ibm.com/> All Rights Reserved.
.PP
This documentation is covered by the \s-1IBM\s0 Public License Version 1.0.  It was
converted from \s-1HTML\s0 to \s-1POD\s0 by software written by Chas Williams and Russ
Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.
