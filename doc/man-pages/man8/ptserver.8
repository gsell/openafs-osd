.\" Automatically generated by Pod::Man 2.16 (Pod::Simple 3.05)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "PTSERVER 8"
.TH PTSERVER 8 "2010-12-15" "OpenAFS" "AFS Command Reference"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
ptserver \- Initializes the Protection Server
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fBptserver\fR [\fB\-database\fR\ |\ \fB\-db\fR\ <\fIdb\ path\fR>] [\fB\-p\fR\ <\fInumber\ of\ threads\fR>] [\fB\-d\fR\ <\fIdebug\ level\fR>]
    [\fB\-groupdepth\fR\ <\fI#\ of\ nested\ groups\fR>]
    [\fB\-default_access\fR\ <\fIuser\ access\ mask\fR>\ <\fIgroup\ access\ mask\fR>]
    [\fB\-restricted\fR] [\fB\-enable_peer_stats\fR]
    [\fB\-enable_process_stats\fR] [\fB\-allow\-dotted\-principals\fR]
    [\fB\-rxbind\fR] [\fB\-auditlog\fR\ <\fIfile\ path\fR>]
    [\fB\-audit\-interface\fR\ (file\ |\ sysvmq)]
    [\fB\-syslog\fR[=<\fI\s-1FACILITY\s0\fR>]] [\fB\-rxmaxmtu\fR\ <\fIbytes\fR>]
    [\fB\-help\fR]
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
The \fBptserver\fR command initializes the Protection Server, which must run
on every database server machine. In the conventional configuration, its
binary file is located in the \fI/usr/afs/bin\fR directory on a file server
machine.
.PP
The ptserver command is not normally issued at the command shell prompt,
but rather placed into a database server machine's
\&\fI/usr/afs/local/BosConfig\fR file with the \fBbos create\fR command. If it is
ever issued at the command shell prompt, the issuer must be logged onto a
file server machine as the local superuser \f(CW\*(C`root\*(C'\fR.
.PP
The Protection Server performs the following tasks:
.IP "\(bu" 4
Maintains the Protection Database, which contains entries for every user
and group in the cell. Use the \fBpts\fR commands to administer the database.
.IP "\(bu" 4
Allocates \s-1AFS\s0 IDs for new user, machine and group entries and maps each \s-1ID\s0
to the corresponding name.
.IP "\(bu" 4
Generates a current protection subgroup (\s-1CPS\s0) at the File Server's
request. The \s-1CPS\s0 lists all groups to which a user or machine belongs.
.PP
When using Kerberos 5, cross-realm authentication is possible. If the
special pts group system:authuser@FOREIGN.REALM exists and its group quota
is greater than zero, \fBaklog\fR will automatically create an entry for the
foreign user in the local \s-1PTS\s0 database and add the foreign user to the
system:authuser@FOREIGN.REALM \s-1PTS\s0 group.  Each time a foreign user is
created in the local \s-1PTS\s0 database, the group quota for the
system:authuser@FOREIGN.REALM \s-1PTS\s0 group is decremented by one.
.PP
This command does not use the syntax conventions of the \s-1AFS\s0 command
suites. Provide the command name and all option names in full.
.SH "OPTIONS"
.IX Header "OPTIONS"
.IP "\fB\-d\fR <\fIdebug level\fR>" 4
.IX Item "-d <debug level>"
Sets the detail level for the debugging trace written to the
\&\fI/usr/afs/logs/PtLog\fR file. Provide one of the following values, each
of which produces an increasingly detailed trace: \f(CW0\fR, \f(CW1\fR, \f(CW5\fR, \f(CW25\fR,
and \f(CW125\fR.
.IP "\fB\-database\fR <\fIdb path\fR>, \fB\-db\fR <\fIdb path\fR>" 4
.IX Item "-database <db path>, -db <db path>"
Specifies the pathname of an alternate directory in which the Protection
Database files reside. Provide the complete pathname, ending in the base
filename to which the \f(CW\*(C`.DB0\*(C'\fR and \f(CW\*(C`.DBSYS1\*(C'\fR extensions are appended. For
example, the appropriate value for the default database files is
\&\fI/usr/afs/db/prdb\fR.
.IP "\fB\-p\fR <\fInumber of threads\fR>" 4
.IX Item "-p <number of threads>"
Sets the number of server lightweight processes (LWPs or pthreads) to run.
Provide a positive integer from the range \f(CW3\fR to \f(CW16\fR. The default
value is \f(CW3\fR.
.IP "\fB\-groupdepth\fR <\fI# of nested groups\fR>, \fB\-depth\fR <\fI# of nested groups\fR>" 4
.IX Item "-groupdepth <# of nested groups>, -depth <# of nested groups>"
Specifies the group depth for nested groups when \fBptserver\fR is compiled
with the \s-1SUPERGROUPS\s0 option enabled.  The default depth for nested groups
is 5.  This option may be shortened to \fB\-depth\fR.
.IP "\fB\-default_access\fR <\fIuser access\fR> <\fIgroup access\fR>" 4
.IX Item "-default_access <user access> <group access>"
Specifies the default user and group privacy flags to apply to each
entry. Provide a string of five characters, one for each of the
permissions. See \fIpts_examine\fR\|(1) or \fIpts_setfields\fR\|(1) for more
information on the flags.
.IP "\fB\-restricted\fR" 4
.IX Item "-restricted"
Run the \s-1PT\s0 Server in restricted mode. While in restricted mode, only
members of the system:administrators \s-1PTS\s0 group may make any \s-1PTS\s0 changes.
.IP "\fB\-enable_peer_stats\fR" 4
.IX Item "-enable_peer_stats"
Activates the collection of Rx statistics and allocates memory for their
storage. For each connection with a specific \s-1UDP\s0 port on another machine,
a separate record is kept for each type of \s-1RPC\s0 (FetchFile, GetStatus, and
so on) sent or received. To display or otherwise access the records, use
the Rx Monitoring \s-1API\s0.
.IP "\fB\-enable_process_stats\fR" 4
.IX Item "-enable_process_stats"
Activates the collection of Rx statistics and allocates memory for their
storage. A separate record is kept for each type of \s-1RPC\s0 (FetchFile,
GetStatus, and so on) sent or received, aggregated over all connections to
other machines. To display or otherwise access the records, use the Rx
Monitoring \s-1API\s0.
.IP "\fB\-allow\-dotted\-principals\fR" 4
.IX Item "-allow-dotted-principals"
By default, the \s-1RXKAD\s0 security layer will disallow access by Kerberos
principals with a dot in the first component of their name. This is to
avoid the confusion where principals user/admin and user.admin are both
mapped to the user.admin \s-1PTS\s0 entry. Sites whose Kerberos realms don't have
these collisions between principal names may disable this check by
starting the server with this option.
.IP "\fB\-rxbind\fR" 4
.IX Item "-rxbind"
Bind the Rx socket to the primary interface only.  (If not specified, the
Rx socket will listen on all interfaces.)
.IP "\fB\-syslog\fR[=<\fIsyslog facility\fR>]" 4
.IX Item "-syslog[=<syslog facility>]"
Specifies that logging output should go to syslog instead of the normal
log file.  \fB\-syslog\fR=\fI\s-1FACILITY\s0\fR can be used to specify to which facility
the log message should be sent.  Logging message sent to syslog are tagged
with the string \*(L"ptserver\*(R".
.IP "\fB\-auditlog\fR <\fIlog path\fR>" 4
.IX Item "-auditlog <log path>"
Turns on audit logging, and sets the path for the audit log.  The audit
log records information about \s-1RPC\s0 calls, including the name of the \s-1RPC\s0
call, the host that submitted the call, the authenticated entity (user)
that issued the call, the parameters for the call, and if the call
succeeded or failed.
.IP "\fB\-audit\-interface\fR (file | sysvmq)" 4
.IX Item "-audit-interface (file | sysvmq)"
Specifies what audit interface to use. Defaults to \f(CW\*(C`file\*(C'\fR. See
\&\fIfileserver\fR\|(8) for an explanation of each interface.
.IP "\fB\-rxmaxmtu\fR <\fIbytes\fR>" 4
.IX Item "-rxmaxmtu <bytes>"
Sets the maximum transmission unit for the \s-1RX\s0 protocol.
.IP "\fB\-help\fR" 4
.IX Item "-help"
Prints the online help for this command. All other valid options are
ignored.
.SH "EXAMPLES"
.IX Header "EXAMPLES"
The following \fBbos create\fR command creates a \f(CW\*(C`ptserver\*(C'\fR process on the
machine \f(CW\*(C`fs3.abc.com\*(C'\fR. The command appears here on multiple lines only
for legibility.
.PP
.Vb 2
\&   % bos create \-server fs3.abc.com \-instance ptserver \e
\&                \-type simple \-cmd /usr/afs/bin/ptserver
.Ve
.SH "PRIVILEGE REQUIRED"
.IX Header "PRIVILEGE REQUIRED"
The issuer must be logged in as the superuser \f(CW\*(C`root\*(C'\fR on a file server
machine to issue the command at a command shell prompt. It is conventional
instead to create and start the process by issuing the \fBbos create\fR
command.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIBosConfig\fR\|(5),
\&\fIprdb.DB0\fR\|(5),
\&\fIbos_create\fR\|(8),
\&\fIbos_getlog\fR\|(8),
\&\fIpts\fR\|(1)
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
\&\s-1IBM\s0 Corporation 2000. <http://www.ibm.com/> All Rights Reserved.
.PP
This documentation is covered by the \s-1IBM\s0 Public License Version 1.0.  It was
converted from \s-1HTML\s0 to \s-1POD\s0 by software written by Chas Williams and Russ
Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.
