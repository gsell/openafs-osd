.\" Automatically generated by Pod::Man 2.23 (Pod::Simple 3.14)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "VLDB_CONVERT 8"
.TH VLDB_CONVERT 8 "2011-09-06" "OpenAFS" "AFS Command Reference"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
vldb_convert \- Convert the VLDB to/from Transarc AFS versions 3.1\-3.4a
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fBvldb_convert\fR [\fBinitcmd\fR] [\fB\-to\fR]\ <\fI\s-1AFS\s0\ version\ goal\fR>
    [\fB\-from\fR]\ <\fIcurrent\ \s-1AFS\s0\ version\fR>
    [\fB\-path\fR]\ <\fIpath\ to\ \s-1VLDB\s0\ file\fR> [\fB\-showversion\fR]
    [\fB\-dumpvldb\fR] [\fB\-help\fR]
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
The \fBvldb_convert\fR command is used to convert legacy Transarc 3.1\-3.4
\&\s-1VLDB\s0 database files between versions. This command is not needed when
using OpenAFS except in the case of preparing to migrate a pre\-3.4 version
of Transarc \s-1AFS\s0 to OpenAFS.
.PP
In order to convert the \s-1VLDB\s0 file, do the following:
.IP "1." 4
Shutdown the \fBvlserver\fR process on all server machines. \fBvlserver\fR is
typically run only on the Cell servers, which must be listed in
\&\fICellServDB\fR or \s-1DNS\s0.
.IP "2." 4
Backup the \s-1VLDB\s0 file \fI/usr/afs/db/vldb.DB0\fR on the sync site to a safe
place. Typically, the sync site if the machine with the lowest \s-1IP\s0 address.
.IP "3." 4
Remove the \fI/usr/afs/db/vldb.DBSYS1\fR file from all cell server machines.
.IP "4." 4
Remove the \fI/usr/afs/db/vldb.DB0\fR file from the non-sync site server
machines.
.IP "5." 4
Run the \fBvldb_convert\fR command on the \s-1VLDB\s0 file using the following
command:
.Sp
.Vb 1
\&   # vldb_convert \-path /usr/afs/db/vldb.DB0
.Ve
.IP "6." 4
Copy the new version of the vlserver binaries to all Cell servers.
.IP "7." 4
Restart the vlserver process on all Cell servers. The new \s-1VLDB\s0 will be
distributed to all of the Cell servers.
.IP "8." 4
Confirm that all Cell servers are synchronized and that the vldb looks in
good shape.
.SH "CAUTIONS"
.IX Header "CAUTIONS"
Backup the \s-1VLDB\s0 file to a different directory or machine before performing
the upgrade. Be sure that all vlserver processes are always running the
same version. This requires downtime, but for this conversion, all
vlserver instances must be at the same version. This restriction is
relaxed in OpenAFS.
.SH "OPTIONS"
.IX Header "OPTIONS"
.IP "[\fBinitcmd\fR]" 4
.IX Item "[initcmd]"
This is an optional string that does nothing.
.IP "[\fB\-to\fR] <\fI\s-1AFS\s0 version goal\fR>" 4
.IX Item "[-to] <AFS version goal>"
This option is required when downgrading or when upgrading to a version
less than 3.4.  Specify 1, 2, 3, or 4 to choose version 3.1, 3.2, 3.3, or
3,4 respectively. This defaults to version 3.4.
.IP "[\fB\-from\fR] <\fIcurrent \s-1AFS\s0 version\fR>" 4
.IX Item "[-from] <current AFS version>"
This option is required when downgrading. Specify 1, 2, 3, or 4 to choose
version 3.1, 3.2, 3.3, or 3.4 respectively.
.IP "[\fB\-path\fR] <\fIpath to \s-1VLDB\s0 file\fR>" 4
.IX Item "[-path] <path to VLDB file>"
Specifies the path the \s-1VLDB\s0 file. This defaults to \fI/usr/afs/db/vldb.DB0\fR
and only needs to be used if the \s-1VLDB\s0 file is not in the default path..
.IP "\fB\-showversion\fR" 4
.IX Item "-showversion"
Shows the current version of the \s-1VLDB\s0. This option can only be used by itself.
.IP "\fB\-dumpvldb\fR" 4
.IX Item "-dumpvldb"
Produces verbose debugging output during the conversion process.
.IP "\fB\-help\fR" 4
.IX Item "-help"
Prints the online help for this command. All other valid options are
ignored.
.SH "PRIVILEGE REQUIRED"
.IX Header "PRIVILEGE REQUIRED"
The issuer must have read and write access to the file
\&\fI/usr/afs/db/vldb.DB0\fR. This usually means that root access is required
on the cell server machines.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIvlserver\fR\|(8)
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
Copyright 2008 Jason Edgecombe <jason@rampaginggeek.com>
.PP
This documentation is covered by the \s-1BSD\s0 License as written in the
doc/LICENSE file. This man page was written by Jason Edgecombe for
OpenAFS.
